{
  "meta:license": [
    "Copyright 2018 Adobe. All rights reserved.",
    "This file is licensed to you under the Apache License, Version 2.0 (the \"License\");",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at http://www.apache.org/licenses/LICENSE-2.0",
    "",
    "Unless required by applicable law or agreed to in writing, software distributed under",
    "the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS",
    "OF ANY KIND, either express or implied. See the License for the specific language",
    "governing permissions and limitations under the License."
  ],
  "$id": "https://ns.adobe.com/helix/pipeline/rawrequest",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Raw Request",
  "type": "object",
  "meta:status": "experimental",
  "description": "The Request Object used for Invoking OpenWhisk",
  "definitions": {
    "rawrequest": {
      "additionalProperties": false,
      "properties": {
        "headers": {
          "type": "object",
          "description": "The headers of the request made to OpenWhisk/Petridish",
          "additionalProperties": {
            "type": "string"
          },
          "properties": {
            "x-openwhisk-activation-id": {
              "type": "string",
              "description": "OpenWhisk Activation ID"
            },
            "x-request-id": {
              "type": "string",
              "description": "Request ID generated by OpenWhisk"
            },
            "x-cdn-request-id": {
              "type": "string",
              "description": "Request ID generated by the CDN"
            },
            "x-backend-name": {
              "type": "string",
              "description": "Name of the Backend handling the request.",
              "meta:enum": {
                "localhost--F_Petridish": "Fake Backend name of the local Petridish server"
              }
            }
          }
        },
        "method": {
          "type": "string",
          "description": "The HTTP method of the request made to OpenWhisk/Petridish. Note: OpenWhisk converts all methods to lowercase.",
          "meta:enum": {
            "get": "GET request",
            "post": "POST request",
            "put": "PUT request (not handled by Helix)",
            "delete": "DELETE request (not handled by Helix)"
          }
        },
        "params": {
          "type": "object",
          "description": "Parameters used to invoke the OpenWhisk action. These are either URL parameters added when invoking the action from the CDN or default parameters set during creation of the action.",
          "additionalProperties": {
            "type": "string",
            "description": "All other parameters are interpretet as string."
          },
          "properties": {
            "owner": {
              "type": "string",
              "description": "Owner of the GitHub repository. This is the name of a user or organization."
            },
            "repo": {
              "type":"string",
              "description": "Repository where content originates"
            },
            "ref": {
              "type": "string",
              "description": "Name of the branch or tag or the SHA of the commit"
            },
            "path": {
              "type": "string",
              "description": "Path to the requested (Markdown) file"
            },
            "strain": {
              "type": "string",
              "description": "The resolved strain (variant)"
            },
            "__ow_headers": {
              "type": "object",
              "description": "Deprecated: The original OpenWhisk request headers"
            }
          }
        }
      }
    }
  },
  "allOf": [
    {"$ref": "#/definitions/rawrequest"}
  ]
}
